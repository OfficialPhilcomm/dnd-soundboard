!!! 5
%html
  %head
    %title App created with staticz

    %meta{charset: "ISO-8859-1"}

    %meta{name: "description", content: "Site description"}
    %meta{name: "keywords", content: "website, staticz"}
    %meta{name: "viewport", content: "width=device-width, initial-scale=1"}

    %meta{property: "og:site_name", content: "example.com"}
    %meta{property: "og:title", content: "Site created with staticz"}
    %meta{property: "og:description", content: "Site description"}
    %meta{property: "og:type", content: "website"}
    %meta{property: "og:url", content: "https://example.com/"}
    %meta{property: "og:title", content: "App created with staticz"}

    %link{rel: "preconnect", href: "https://fonts.googleapis.com"}
    %link{rel: "preconnect", href: "https://fonts.gstatic.com", crossorigin: true}
    %link{href: "https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;700&display=swap", rel: "stylesheet"}

    %link{href: 'https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css', rel: 'stylesheet'}

    %script{type: "module"}
      :plain
        import { Application } from "https://unpkg.com/@hotwired/stimulus/dist/stimulus.js"
        window.Stimulus = Application.start()

    %script{type: "module", src: js_sound_controller_path}

    :javascript
      current_audio = null

      function sleep(milliseconds) {
        return new Promise(resolve => setTimeout(resolve, milliseconds));
      }

    = stylesheet css_main_path

    = reload_js
  %body
    %main.soundBoard
      - sounds = load_sounds

      - sounds_by_category = load_sounds.group_by(&:category)

      - sounds_by_category.each do |category, category_sounds|
        .soundBoard-category
          .soundBoard-category-title= category || "Uncategorized"
          .soundBoard-category-sounds
            - category_sounds.each do |sound|
              .soundBoard-category-sounds-soundContainer
                .soundBoard-category-sounds-soundContainer-sound{data: {controller: "sound", sound_target: "root"}}
                  %audio{src: "sounds/#{sound.name}.mp3", data: {sound_target: "sound"}}

                  .soundBoard-category-sounds-soundContainer-sound-name= sound.name

                  %i.bx.bx-play-circle.soundBoard-category-sounds-soundContainer-sound-play{data: {action: "click->sound#play"}}
                  %i.bx.bx-stop-circle.soundBoard-category-sounds-soundContainer-sound-stop{data: {action: "click->sound#stop"}}
